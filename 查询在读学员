-- 所有在读学员查询
-- SELECT u.id
-- ,u.`name`
-- ,u.mobile,cr.customer_province,cr.customer_city
-- 
-- from ol_user u
-- LEFT JOIN ol_clink_call_records cr on cr.customer_number=u.mobile
-- LEFT JOIN ol_live_class_student cs on cs.student_id=u.id
-- WHERE u.payed_student_status=2 and cs.remain_live>0
-- GROUP BY 1

--  用户ID	学员昵称	电话	阶段	班型	上课时间	正课教师艺名
 
 -- 4月在读学员
SELECT 用户ID,学员昵称,阶段,班型,上课时间,正课教师艺名 from
(SELECT u.id 用户ID
,u.`name` 学员昵称
,cc.`name` 阶段
,l.max_class_num 班型
,FROM_UNIXTIME(l.start_time) 上课时间
,au.nickname 正课教师艺名

from ol_user u
LEFT JOIN ol_live_class_student cs on cs.student_id=u.id
LEFT JOIN ol_live l on l.class_id=cs.class_id
LEFT JOIN ol_course_category cc on cc.id=l.cate_sid
LEFT JOIN ol_admin_user au on au.id=l.teacher_id
LEFT JOIN ol_live_student ls on ls.live_id=l.id
WHERE u.payed_student_status=2 and cs.remain_live>0 and ls.check_status =1 and l.course_type=1
and l.start_time BETWEEN UNIX_TIMESTAMP('2019-04-01') and UNIX_TIMESTAMP('2019-05-01')

ORDER BY u.id,l.start_time desc) as tmp
GROUP BY 用户ID
